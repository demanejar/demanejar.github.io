<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta property="og:image" content="https://raw.githubusercontent.com/demanejar/image-collection/main/SparkMLlib/sparkmllogo.png"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-9TR0K3B846"></script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8714452693053438" crossorigin="anonymous"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-9TR0K3B846'); </script><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Bài toán phân cụm với Spark ML và xây dựng ứng dụng với Flask" /><meta name="author" content="trannguyenhan" /><meta property="og:locale" content="en_US" /><meta name="description" content="Spark MLlib là thư viện học máy của Spark được tạo ra với mục tiêu có thể giải quyết các bài toán ML một cách dễ dàng hơn. Mặc dùng các thư viện mà MLlib mang lại không phong phú bằng python với những sklearn, tensorflow, PyTorch,… Tuy nhiên MLlib hỗ trợ cho chương trình của bạn có thể chạy phân tán trên nhiều máy tại cụm Spark được thiết lập trước đó." /><meta property="og:description" content="Spark MLlib là thư viện học máy của Spark được tạo ra với mục tiêu có thể giải quyết các bài toán ML một cách dễ dàng hơn. Mặc dùng các thư viện mà MLlib mang lại không phong phú bằng python với những sklearn, tensorflow, PyTorch,… Tuy nhiên MLlib hỗ trợ cho chương trình của bạn có thể chạy phân tán trên nhiều máy tại cụm Spark được thiết lập trước đó." /><link rel="canonical" href="https://demanejar.github.io/posts/sparkml/" /><meta property="og:url" content="https://demanejar.github.io/posts/sparkml/" /><meta property="og:site_name" content="De Manejar" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-15T20:52:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Bài toán phân cụm với Spark ML và xây dựng ứng dụng với Flask" /><meta name="twitter:site" content="@DeManejar" /><meta name="twitter:creator" content="@trannguyenhan" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"trannguyenhan"},"dateModified":"2025-03-17T06:29:35+07:00","datePublished":"2021-11-15T20:52:00+07:00","description":"Spark MLlib là thư viện học máy của Spark được tạo ra với mục tiêu có thể giải quyết các bài toán ML một cách dễ dàng hơn. Mặc dùng các thư viện mà MLlib mang lại không phong phú bằng python với những sklearn, tensorflow, PyTorch,… Tuy nhiên MLlib hỗ trợ cho chương trình của bạn có thể chạy phân tán trên nhiều máy tại cụm Spark được thiết lập trước đó.","headline":"Bài toán phân cụm với Spark ML và xây dựng ứng dụng với Flask","mainEntityOfPage":{"@type":"WebPage","@id":"https://demanejar.github.io/posts/sparkml/"},"url":"https://demanejar.github.io/posts/sparkml/"}</script><title>Bài toán phân cụm với Spark ML và xây dựng ứng dụng với Flask | De Manejar</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://i.pinimg.com/564x/9c/32/79/9c3279b5ac960533cbcb7e833ac4d947.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">De Manejar</a></div><div class="site-subtitle font-italic">Hello Bigdata !</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/demanejar" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/DeManejar" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['demanejar','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Bài toán phân cụm với Spark ML và xây dựng ứng dụng với Flask</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Bài toán phân cụm với Spark ML và xây dựng ứng dụng với Flask</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> trannguyenhan </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Nov 15, 2021, 8:52 PM +0700" prep="on" > Nov 15, 2021 <i class="unloaded">2021-11-15T20:52:00+07:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Mar 17, 2025, 6:29 AM +0700" prefix="Updated " > Mar 17 <i class="unloaded">2025-03-17T06:29:35+07:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1278 words">7 min</span></div></div><div class="post-content"><p>Spark MLlib là thư viện học máy của Spark được tạo ra với mục tiêu có thể giải quyết các bài toán ML một cách dễ dàng hơn. Mặc dùng các thư viện mà MLlib mang lại không phong phú bằng python với những sklearn, tensorflow, PyTorch,… Tuy nhiên MLlib hỗ trợ cho chương trình của bạn có thể chạy phân tán trên nhiều máy tại cụm Spark được thiết lập trước đó.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/demanejar/image-collection/main/SparkMLlib/sparkml.png" alt="" /></p><p>Ở mức cao, Spark MLlib cung cấp một số thư viện và công cụ như là:</p><ul><li>ML Algorithms: là các thư viện thuật toán được xây dựng sẵn như là các thuật toán classification, regresion, clustering hay collaborative filtering<li>Featurization: trích xuất tính năng, chuyển đổi, giảm kích thước và lựa chọn<li>Persistence: các thuật toán sau khi train có thể lưu và load lại một cách dễ dàng<li>Utilities: xử lý dữ liệu, phân tích và thống kê,…</ul><p>Trong bài viết lần này mình sẽ minh họa bài toán phân cụm với LDA bằng Spark MLlib và sử dụng Flask để viết API cho ứng dụng Spark MLlib này.</p><p>Theo ý kiến của riêng mình, với những thuật toán MLlib thì việc sử dụng các ngôn ngữ thông dịch và đặc biệt là Python sẽ hợp lý hơn vì sự hỗ trợ và cộng đồng mà nó mang lại, vì vậy không giống như những modules khác mình thích sử dụng Java thì với Spark MLlib mình lại ưa thích hơn việc sử dụng Python.</p><h2 id="chuẩn-bị-dữ-liệu-đầu-vào">Chuẩn bị dữ liệu đầu vào</h2><p>Dữ liệu đầu vào phải được quy định trước về định dạng và các trường để cho người làm dữ liệu và người làm mô hình có sự thống nhất, với Spark một số định dạng phổ biến được hỗ trợ đọc và ghi trực tiếp như là <code class="language-plaintext highlighter-rouge">parquet</code>, <code class="language-plaintext highlighter-rouge">json</code>, <code class="language-plaintext highlighter-rouge">csv</code>,… và chúng đều là những định dạng lưu trữ phổ biến và cực kì quen thuộc.</p><p>Trong bài ví dụ này chúng ta sẽ sử dụng định dạng dữ liệu <code class="language-plaintext highlighter-rouge">csv</code> với 3 trường dữ liệu đầu vào là <code class="language-plaintext highlighter-rouge">title</code>, <code class="language-plaintext highlighter-rouge">content</code>, <code class="language-plaintext highlighter-rouge">date</code>. Tuy nhiên, việc phân loại hiện tại chỉ sử dụng trường <code class="language-plaintext highlighter-rouge">content</code>, 2 trường <code class="language-plaintext highlighter-rouge">title</code> và <code class="language-plaintext highlighter-rouge">date</code> các bạn có thể mở rộng thêm để tăng tính chính xác cho mô hình bài toán.</p><h2 id="tiền-xử-lý">Tiền xử lý</h2><p>Dữ liệu trước khi đưa vào mô hình cũng phải được xử lý như là xóa đi những stopword, những dấu cách, dấu phẩy thừa, chuẩn hóa tất cả về dạng viết thường,…</p><p>Những công việc này các thư viện do Python cung cấp đã hỗ trợ rất tốt, nếu bạn đang làm bài toán với tiếng Anh thì có thể sử dụng ngay thư viện <code class="language-plaintext highlighter-rouge">nltk</code>, còn nếu sử dụng tiếng Việt thì chắc sẽ phải tự tạo kho từ điển stopword của riêng mình.</p><p>Với hàm tiền xử lý này, đầu vào sẽ nhận một RDD và sẽ trả ra 1 RDD đã được xử lý:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">import</span> <span class="n">re</span> <span class="k">as</span> <span class="n">re</span>

<span class="c1"># pre processing data
</span><span class="k">def</span> <span class="nf">preprocessing</span><span class="p">(</span><span class="n">rdd</span><span class="p">):</span>
	<span class="n">reviews</span> <span class="o">=</span> <span class="n">rdd</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="sh">'</span><span class="s">Content</span><span class="sh">'</span><span class="p">]).</span><span class="nf">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span>
	<span class="n">StopWords</span> <span class="o">=</span> <span class="n">stopwords</span><span class="p">.</span><span class="nf">words</span><span class="p">(</span><span class="sh">"</span><span class="s">english</span><span class="sh">"</span><span class="p">)</span>
	<span class="n">tokens</span> <span class="o">=</span> <span class="n">reviews</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">document</span><span class="p">:</span> <span class="n">document</span><span class="p">.</span><span class="nf">strip</span><span class="p">().</span><span class="nf">lower</span><span class="p">())</span>
	<span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">document</span><span class="p">:</span> <span class="n">re</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">,</span> <span class="n">document</span><span class="p">))</span>
	<span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">word</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">word</span> <span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="nf">isalpha</span><span class="p">()])</span>
	<span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">word</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">word</span> <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">])</span>
	<span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">word</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">word</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">StopWords</span><span class="p">])</span>

	<span class="k">return</span> <span class="n">tokens</span>
</pre></table></code></div></div><h2 id="xây-dựng-mô-hình-phân-cụm-với-lda">Xây dựng mô hình phân cụm với LDA</h2><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">shutil</span>

<span class="kn">from</span> <span class="n">pyspark</span> <span class="kn">import</span> <span class="n">SparkContext</span><span class="p">,</span> <span class="n">SparkConf</span>
<span class="kn">from</span> <span class="n">pyspark.sql</span> <span class="kn">import</span> <span class="n">SQLContext</span>
<span class="kn">from</span> <span class="n">pyspark.ml.clustering</span> <span class="kn">import</span> <span class="n">LDA</span>
<span class="kn">from</span> <span class="n">pyspark.ml.feature</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>

<span class="kn">from</span> <span class="n">preprocessing</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">import</span> <span class="n">constants</span>

<span class="c1"># init Spark Context
</span><span class="n">conf</span> <span class="o">=</span> <span class="nc">SparkConf</span><span class="p">().</span><span class="nf">setAppName</span><span class="p">(</span><span class="sh">"</span><span class="s">Spark ML</span><span class="sh">"</span><span class="p">).</span><span class="nf">setMaster</span><span class="p">(</span><span class="sh">"</span><span class="s">local[2]</span><span class="sh">"</span><span class="p">)</span>
<span class="n">sc</span> <span class="o">=</span> <span class="nc">SparkContext</span><span class="p">(</span><span class="n">conf</span><span class="o">=</span><span class="n">conf</span><span class="p">)</span>
<span class="n">sqlContext</span> <span class="o">=</span> <span class="nc">SQLContext</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>

<span class="c1"># read raw data
</span><span class="n">data</span> <span class="o">=</span> <span class="n">sqlContext</span><span class="p">.</span><span class="n">read</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="sh">"</span><span class="s">csv</span><span class="sh">"</span><span class="p">).</span><span class="nf">options</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="sh">'</span><span class="s">true</span><span class="sh">'</span><span class="p">,</span> <span class="n">inferSchema</span><span class="o">=</span><span class="sh">'</span><span class="s">true</span><span class="sh">'</span><span class="p">).</span><span class="nf">load</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">realpath</span><span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">PATH</span><span class="p">))</span>

<span class="n">rdd</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">rdd</span>

<span class="c1"># preprocessing data
</span><span class="n">tokens</span> <span class="o">=</span> <span class="nf">preprocessing</span><span class="p">(</span><span class="n">rdd</span><span class="p">)</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">.</span><span class="nf">zipWithIndex</span><span class="p">()</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">sqlContext</span><span class="p">.</span><span class="nf">createDataFrame</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="p">[</span><span class="sh">"</span><span class="s">content</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">index</span><span class="sh">"</span><span class="p">])</span>

<span class="c1"># vector data
</span><span class="n">cv</span> <span class="o">=</span> <span class="nc">CountVectorizer</span><span class="p">(</span><span class="n">inputCol</span><span class="o">=</span><span class="sh">"</span><span class="s">content</span><span class="sh">"</span><span class="p">,</span> <span class="n">outputCol</span><span class="o">=</span><span class="sh">"</span><span class="s">features</span><span class="sh">"</span><span class="p">,</span> <span class="n">vocabSize</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">minDF</span><span class="o">=</span><span class="mf">3.0</span><span class="p">)</span>
<span class="n">cvModel</span> <span class="o">=</span> <span class="n">cv</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">vectorizedToken</span> <span class="o">=</span> <span class="n">cvModel</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># clustering
</span><span class="n">lda</span> <span class="o">=</span> <span class="nc">LDA</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">constants</span><span class="p">.</span><span class="n">NUM_TOPICS</span><span class="p">,</span> <span class="n">maxIter</span><span class="o">=</span><span class="n">constants</span><span class="p">.</span><span class="n">MAX_INTER</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">lda</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">vectorizedToken</span><span class="p">)</span>

<span class="c1"># get vocab
</span><span class="n">vocab</span> <span class="o">=</span> <span class="n">cvModel</span><span class="p">.</span><span class="n">vocabulary</span>
<span class="n">topics</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">describeTopics</span><span class="p">()</span>
<span class="n">topicsRdd</span> <span class="o">=</span> <span class="n">topics</span><span class="p">.</span><span class="n">rdd</span>

<span class="c1"># result
</span><span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">vectorizedToken</span><span class="p">)</span>
<span class="n">result</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="c1"># save model
</span><span class="nf">if</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">isdir</span><span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="sh">"</span><span class="s">/Model_CountVectorizer</span><span class="sh">"</span><span class="p">)):</span>
	<span class="n">shutil</span><span class="p">.</span><span class="nf">rmtree</span><span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="sh">"</span><span class="s">/Model_CountVectorizer</span><span class="sh">"</span><span class="p">)</span>
<span class="n">cvModel</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="sh">"</span><span class="s">/Model_CountVectorizer</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">if</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">isdir</span><span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="sh">"</span><span class="s">/Model_LDA</span><span class="sh">"</span><span class="p">)):</span>
	<span class="n">shutil</span><span class="p">.</span><span class="nf">rmtree</span><span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="sh">"</span><span class="s">/Model_LDA</span><span class="sh">"</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="sh">"</span><span class="s">/Model_LDA</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>Một số hằng số <code class="language-plaintext highlighter-rouge">constants.NUM_TOPICS</code>, <code class="language-plaintext highlighter-rouge">constants.OUTPUT_PATH</code>, <code class="language-plaintext highlighter-rouge">constants.OUTPUT_PATH</code>, <code class="language-plaintext highlighter-rouge">constants.MAX_INTER</code> là các hằng số đã được khai báo trước trong file <code class="language-plaintext highlighter-rouge">constants.py</code> để tiện cho việc sử dụng và thay đổi một cách dễ dàng<li>Trong phần minh họa code trên cũng đã có comment giải thích khá rõ cho từng phần nên mình cũng không giải thích gì thêm nữa</ul><p>Sau khi save model chúng ta cũng có thể lôi ra sử dụng lại một cách dễ dàng:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pyspark.ml.clustering</span> <span class="kn">import</span> <span class="n">LocalLDAModel</span>
<span class="kn">from</span> <span class="n">pyspark.ml.feature</span> <span class="kn">import</span> <span class="n">CountVectorizer</span><span class="p">,</span> <span class="n">CountVectorizerModel</span>

<span class="n">countVectorizerModel</span> <span class="o">=</span> <span class="n">CountVectorizerModel</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="sh">"</span><span class="s">/Model_CountVectorizer</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ldaModel</span> <span class="o">=</span> <span class="n">LocalLDAModel</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="sh">"</span><span class="s">/Model_LDA</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="viết-api-cho-ứng-dụng-spark-mllib-với-flask">Viết API cho ứng dụng Spark MLlib với Flask</h2><p><strong>Flask</strong> là một <strong>Web Framework</strong> rất nhẹ của <strong>Python</strong>, dễ dàng giúp người mới bắt đầu học Python có thể tạo ra website nhỏ. <strong>Flask</strong> cũng <strong>dễ mở rộng</strong> để xây dựng các ứng dụng web phức tạp. Nói chung để xây dựng một ứng dụng web nhỏ không quá cầu kì với Python thì Flask là một lựa chọn tuyệt vời.</p><p>Sau khi train mô hình và lưu lại chúng giờ đây chúng ta có thể viết một API trả về kết quả phân loại với LDA bằng Flask để có thể phân loại văn bản mới:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pyspark</span> <span class="kn">import</span> <span class="n">SparkContext</span><span class="p">,</span> <span class="n">SparkConf</span>
<span class="kn">from</span> <span class="n">pyspark.sql</span> <span class="kn">import</span> <span class="n">SQLContext</span>
<span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span>
<span class="kn">from</span> <span class="n">pyspark.ml.clustering</span> <span class="kn">import</span> <span class="n">LocalLDAModel</span>
<span class="kn">from</span> <span class="n">pyspark.ml.feature</span> <span class="kn">import</span> <span class="n">CountVectorizerModel</span>

<span class="kn">import</span> <span class="n">constants</span>

<span class="kn">from</span> <span class="n">preprocessing</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="c1"># init Spark Context
</span><span class="n">conf</span> <span class="o">=</span> <span class="nc">SparkConf</span><span class="p">().</span><span class="nf">setAppName</span><span class="p">(</span><span class="sh">"</span><span class="s">Spark ML</span><span class="sh">"</span><span class="p">).</span><span class="nf">setMaster</span><span class="p">(</span><span class="sh">"</span><span class="s">local[2]</span><span class="sh">"</span><span class="p">)</span>
<span class="n">sc</span> <span class="o">=</span> <span class="nc">SparkContext</span><span class="p">(</span><span class="n">conf</span><span class="o">=</span><span class="n">conf</span><span class="p">)</span>
<span class="n">sqlContext</span> <span class="o">=</span> <span class="nc">SQLContext</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>

<span class="c1"># init flask app
</span><span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/api/predict</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">predict</span><span class="p">():</span>
	<span class="n">document</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">document</span><span class="sh">"</span><span class="p">)</span>
	<span class="n">countVectorizerModel</span> <span class="o">=</span> <span class="n">CountVectorizerModel</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="sh">"</span><span class="s">/Model_CountVectorizer</span><span class="sh">"</span><span class="p">)</span>
	<span class="n">ldaModel</span> <span class="o">=</span> <span class="n">LocalLDAModel</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">OUTPUT_PATH</span> <span class="o">+</span> <span class="sh">"</span><span class="s">/Model_LDA</span><span class="sh">"</span><span class="p">)</span>

	<span class="n">documentDF</span> <span class="o">=</span> <span class="n">sqlContext</span><span class="p">.</span><span class="nf">createDataFrame</span><span class="p">([(</span><span class="n">document</span><span class="p">,</span> <span class="p">)],</span> <span class="p">[</span><span class="sh">"</span><span class="s">Content</span><span class="sh">"</span><span class="p">])</span>
	<span class="n">rdd</span> <span class="o">=</span> <span class="n">documentDF</span><span class="p">.</span><span class="n">rdd</span>
	<span class="n">tokens</span> <span class="o">=</span> <span class="nf">preprocessing</span><span class="p">(</span><span class="n">rdd</span><span class="p">)</span>
	<span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">.</span><span class="nf">zipWithIndex</span><span class="p">()</span>

	<span class="n">df</span> <span class="o">=</span> <span class="n">sqlContext</span><span class="p">.</span><span class="nf">createDataFrame</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="p">[</span><span class="sh">"</span><span class="s">content</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">index</span><span class="sh">"</span><span class="p">])</span>
	<span class="n">vectorizedToken</span> <span class="o">=</span> <span class="n">countVectorizerModel</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

	<span class="n">result</span> <span class="o">=</span> <span class="n">ldaModel</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">vectorizedToken</span><span class="p">)</span>
	<span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="nf">select</span><span class="p">(</span><span class="sh">"</span><span class="s">topicDistribution</span><span class="sh">"</span><span class="p">)</span>
	<span class="n">result</span><span class="p">.</span><span class="nf">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

	<span class="n">pred</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="n">rdd</span><span class="p">.</span><span class="nf">first</span><span class="p">()</span>
	<span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">predict</span><span class="sh">"</span><span class="p">:</span> <span class="nf">find_max_index</span><span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="sh">'</span><span class="s">topicDistribution</span><span class="sh">'</span><span class="p">])}</span>

  

<span class="k">def</span> <span class="nf">find_max_index</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
	<span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="nb">max</span> <span class="o">=</span> <span class="mi">0</span>

	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)):</span>
		<span class="k">if</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">:</span>
			<span class="nb">max</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="n">index</span> <span class="o">=</span> <span class="n">i</span>

	<span class="k">return</span> <span class="n">index</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
	<span class="n">app</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>Một số hằng số <code class="language-plaintext highlighter-rouge">constants.OUTPUT_PATH</code> là các hằng số đã được khai báo trước trong file <code class="language-plaintext highlighter-rouge">constants.py</code> để tiện cho việc sử dụng và thay đổi một cách dễ dàng.<li><p>Kết quả sau khi dự đoán sẽ là 1 mảng các xắc suất phân loại lần lượt vào các nhãn như:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>  +------------------------------------------------------------+
  |topicDistribution                                           |
  +------------------------------------------------------------+
  |[0.15073318601831004,0.7068123476592819,0.14245446632240802]|
  +------------------------------------------------------------+
</pre></table></code></div></div><p>hàm <code class="language-plaintext highlighter-rouge">find_max_index</code> để tìm ra nhãn nào có xắc suất cao nhất.</p></ul><h3 id="test-api-với-postman">Test API với Postman</h3><p>Chạy ứng dụng Flask bằng câu lệnh:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python3 app.py
</pre></table></code></div></div><p>Sau đó test thử API bằng postman sẽ thu được kết quả dự đoán:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/demanejar/image-collection/main/SparkMLlib/postman.png" alt="" /></p><p>Xem toàn bộ project trên github tại: <a href="https://github.com/demanejar/sparkml">https://github.com/demanejar/sparkml</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hadoop-spark/'>Hadoop & Spark</a>, <a href='/categories/spark/'>Spark</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/bigdata/" class="post-tag no-text-decoration" >Bigdata</a> <a href="/tags/spark/" class="post-tag no-text-decoration" >Spark</a> <a href="/tags/flask/" class="post-tag no-text-decoration" >Flask</a> <a href="/tags/spark-mllib/" class="post-tag no-text-decoration" >Spark MLlib</a> <a href="/tags/lda/" class="post-tag no-text-decoration" >LDA</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Bài toán phân cụm với Spark ML và xây dựng ứng dụng với Flask - De Manejar&url=https://demanejar.github.io/posts/sparkml/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Bài toán phân cụm với Spark ML và xây dựng ứng dụng với Flask - De Manejar&u=https://demanejar.github.io/posts/sparkml/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Bài toán phân cụm với Spark ML và xây dựng ứng dụng với Flask - De Manejar&url=https://demanejar.github.io/posts/sparkml/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/k8s/">Tìm hiểu tổng quan k8s</a><li><a href="/posts/add-proxy-to-scrapy-project/">Cấu hình proxy cho project Scrapy</a><li><a href="/posts/crawl-1000-website-new-with-scrapy/">Crawl 1000 trang báo với Scrapy và MySQL</a><li><a href="/posts/php-scraper/">PHP Scraper</a><li><a href="/posts/scrapy-shell/">Giới thiệu Scrapy Shell</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/bigdata/">Bigdata</a> <a class="post-tag" href="/tags/spark/">Spark</a> <a class="post-tag" href="/tags/crawler/">Crawler</a> <a class="post-tag" href="/tags/hdfs/">HDFS</a> <a class="post-tag" href="/tags/scrapy/">Scrapy</a> <a class="post-tag" href="/tags/hadoop/">Hadoop</a> <a class="post-tag" href="/tags/apache-hadoop/">Apache Hadoop</a> <a class="post-tag" href="/tags/ubuntu/">Ubuntu</a> <a class="post-tag" href="/tags/spark-sql/">Spark SQL</a> <a class="post-tag" href="/tags/alonhadat/">alonhadat</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/spark-rdd/"><div class="card-body"> <span class="timeago small" > Aug 17, 2021 <i class="unloaded">2021-08-17T20:52:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spark RDD</h3><div class="text-muted small"><p> Resilient Distributed Datasets (RDDs) Resilient Distributed Datasets (RDD) là một cấu trúc dữ liệu cơ bản của Spark. Nó là một tập hợp bất biến phân tán của một đối tượng có thể hoạt động song son...</p></div></div></a></div><div class="card"> <a href="/posts/install-apache-spark-ubuntu/"><div class="card-body"> <span class="timeago small" > Aug 19, 2021 <i class="unloaded">2021-08-19T20:52:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cài đặt Apache Spark standalone</h3><div class="text-muted small"><p> Apache Spark là một framework dùng trong xử lý dữ liệu lớn. Nền tảng này trở nên phổ biến rộng rãi do dễ sử dụng và tốc độ xử lý dữ liệu được cải thiện hơn Hadoop. Apache Spark có thể phân phối khố...</p></div></div></a></div><div class="card"> <a href="/posts/word-count-with-spark-submit-and-spark-shell/"><div class="card-body"> <span class="timeago small" > Aug 24, 2021 <i class="unloaded">2021-08-24T20:52:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Chương trình Word Count với spark-submit và spark-shell</h3><div class="text-muted small"><p> Wordcount cũng là một chương trình kinh điển khi nhắc tới Spark, một phần cũng là để so sánh hiệu năng với chính Hadoop MapReduce. Trong bài viết này mình sẽ hướng dẫn mọi người tạo và chạy chương ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/mode-in-spark/" class="btn btn-outline-primary" prompt="Older"><p>Giải thích về các chế độ chính khi chạy Spark</p></a> <a href="/posts/what-is-crawler-and-something/" class="btn btn-outline-primary" prompt="Newer"><p>Crawler, một số điều mình chia sẻ về crawler và loạt bài viết về crawler sắp tới?</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/DeManejar">demanejar</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div><script type="text/javascript"> var links = document.links; for (var i = 0, linksLength = links.length; i < linksLength; i++) { if (links[i].hostname != window.location.hostname) { links[i].target = '_blank'; } } </script></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/bigdata/">Bigdata</a> <a class="post-tag" href="/tags/spark/">Spark</a> <a class="post-tag" href="/tags/crawler/">Crawler</a> <a class="post-tag" href="/tags/hdfs/">HDFS</a> <a class="post-tag" href="/tags/scrapy/">Scrapy</a> <a class="post-tag" href="/tags/hadoop/">Hadoop</a> <a class="post-tag" href="/tags/apache-hadoop/">Apache Hadoop</a> <a class="post-tag" href="/tags/ubuntu/">Ubuntu</a> <a class="post-tag" href="/tags/spark-sql/">Spark SQL</a> <a class="post-tag" href="/tags/alonhadat/">alonhadat</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://demanejar.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
